Towards a Model of Regional Brain Connectivity using Probabilistic Index of Connectivity
 Jack Hessel,  and Kevin Liao Mikenna Everett,

Introduction
The cerebral cortex is an outer structure of the brain where we encounter gray matter and much of the processing which occurs. Subregions of the cortex are specialized in their capacity to process information; some process visual information, others control human emotion, and so on. This specialization necessitates communication in order to perform complex tasks. White matter fibers inside the brain serve as a communication medium between the various functional regions. Due to uncertainty about the inherent structure of these fibers, it is not firmly established whether, and if so how, various sub-regions are connected. Diffusion weighted imaging provides a noninvasive map of water diffusivity in the brain. Highly anisotropic diffusion in a particular direction implies that the orientation of the fiber is in that direction; thus, we can use diffusion imaging to make inferences about the brain's underlying structure. We can represent these images using diffusion tensors, which are linear transformations modelling underlying diffusivity. Generally, a single tensor is fit for each voxel in an image, resulting in a discrete tensor field. Of particular interest in connectivity studies are tractography methods that use numerical integration to trace continuous paths in vector fields. These streamlines trace the trajectory of fibers from established seed points (or regions of interest) in the brain in an effort to establish underlying fiber structure. Streamline tracing methods, however, can provide varied results due to the deterministic nature
 Department

of the process: tractography is highly sensitive to the seed point chosen such that even two closely neighboring seed points can produce drastically different tracts. Much of this is due to a cumulative effect of increased uncertainty/error when passing through regions of the brain with multiple fiber orientations (and, as a result, misleading diffusion tensors); small local errors drastically alter final streamline traces. Probabilistic tractography extends these tracing algorithms and aims to overcome some of their shortcomings [1, 3]. In particular, the probabilistic index of connectivity (or PICo) method first proposed by Parker et al. [1] generates multiple streamlines via Monte Carlo simulation, ultimately using them to compute an "index of connectivity" over all voxels in an image given a starting region. For a given voxel, the "index of connectivity" corresponds to the number of times a streamline is traced from the starting region to that voxel over every simulation. The larger the index of connectivity in a particular voxel, the more confident we are that a true structural connection exists between the starting region and that voxel. Each Monte Carlo sample introduces variation into the underlying tensor field by slightly perturbing each tensor in accordance with its estimated orientational uncertainty. In this way, we can model the uncertainty of the reconstruction of the underlying tissue structure. The goal of this work is to build on PICo in order to model regional connectivity within the brain. We demonstrate how to use an "augmented PICo" approach to probabilisti-

of Computer Science, Carleton College, Northfield, Minnesota, USA.

1

cally generate a distribution of tracts between a given gray matter sub-region in the cortex and other sub-regions in the cortex. We then discuss how this can help us to infer aspects of inter-cortical connectivity.

gle given starting region, maintaining counts for how many times each voxel contains the endpoint, to create a spatial distribution over potential brain pathways. 0th Order Perturbation Scheme

Theory Probabilistic Index of Connectivity
Probabilistic Index of Connectivity (PICo) is a method of modeling the effect of uncertainty on tractography in tensor fields [1]. Given a seed region, one can determine an estimate for the index of connectivity between that region and all other voxels in the brain by running repeated Monte Carlo simulations and normalizing the result as a probability distribution. We highlight the basic steps of PICo in the following high-level overview. At some given stage in a trace, we find ourselves at a point in space P within a voxel represented by a diffusion tensor D. D represents diffusion for the point at the center of the voxel, but more often than not, P will not be at the exact the voxel center, and we must estimate a new diffusion tensor for P based on what we observe at the voxel centers. In order to interpolate a reasonable diffusion direction for our tract, we examine the 26 nearest tensor neighbors of D in a three dimensional volume. To introduce variation from one simulation to the next, we perturb each of these neighbor tensors based on their levels of fractional anisotropy; the more isotropic, the larger the expected perturbation's magnitude. There are options as to which particular probability density function we draw from to determine these perturbations; we implemented PICo with the 0th order tensor perturbation method as originally described by Parker et al., which we describe in the next subsection. Once all neighbor tensors have been modified to model measurement uncertainty, a new diffusion tensor is calculated by linearly interpolating all of these modified neighbors to our original point P, and tractography continues as before. We trace many streamlines from a sin2

In order to model directional uncertainty and execute Monte Carlo simulations, we need to find a way to probabilistically modify diffusion tensors, especially in voxels with low fractional anisotropy. Here we present the 0th order perturbation scheme originally proposed by Parker et al [1]. At each voxel is a diffusion tensor which can be represented in the following form:   d xx d xy d xz D =  d xy dyy dyz  d xz dyz dzz First, we compute the fractional anisotropy FA of this tensor. The fractional anisotropy acts as a parameter in the following sigmoid function:  ( FA) = 1 + 0.185 1 + e7.5( FA-0.2) (1)

Note that  ( FA) is higher when we are less certain about the direction of diffusion at a voxel. The lower the fractional anisotropy is, the higher the sigma value is. Low fractional anisotropy levels can be the result of various fiber structures that are hard to represent with a tensor (i.e. crossing fibers, kissing fibers, and gray matter) and thus have higher levels of uncertainty associated with them. Equation 1 is based on the sigmoid function used by Parker et al [1]. Once we have , which we now treat as a standard deviation, we draw two random angles from the following distributions:   N (0,  ( FA))   U (0,  ) (2) (3)

These random angles fully characterize our random perturbation. More specifically, let M be a rotation matrix that aligns D's principal eigenvector along the x-axis, M be a rotation

matrix that rotates vectors in the clockwise about the y-axis by  , and M be a rotation matrix that rotates vectors clockwise about the x-axis by . Our perturbed tensor D can be expressed as: D = M - 1 M M M D (4)

Tractography in Modified Tensor Fields
We will implement Euler's method for tractography within probabilistically modified tensor fields. Because we are attempting a continuous tracing through a discretely sampled space, some amount of interpolation is required to determine tensor values at non-integral points. To account for this complexity, Parker et al. suggest the following interpolation scheme: 1. At a given point in the tractographic process, determine the nearest discrete tensor's 26 nearest neighbors. 2. Next, apply the 0th order perturbation scheme to each of those neighboring tensors. 3. Finally, use linear interpolation to determine a probabilistically modified tensor at your starting point. Note that your point will be contained in the convex hull of the neighbors you perturb. Ultimately, this process is used to trace curves through the tensor field.

Cortical Barrier: A Tractographic Stopping Condition
Since we are interested in the interconnectivity of distinct sub-regions of the cortex, we must distinguish between gray matter, white matter and other regions in the brain. Identifying the gray matter reachable via white matter will help us to simplify our search space as well, and it will help to prevent indications of white matter connectivity between sub-regions which are, in truth, connected only by cortical fibers. We refer to this surface of gray matter in direct contact with white matter fibers as the cortical

barrier. The barrier includes gray matter on the brain's surface, and also the surface of internal structures, such as the thalamus. While many studies utilizing tractography terminate when fractional anisotropy drops below a certain threshold [5], our augmented PICo starts in some part of the cortical barrier and will not end a trace until it reaches a new region of the cortical barrier. Additionally, we allow a tract to continue only as long as it remains within white matter, regardless of our certainty in the current direction of travel. We hope that, on average, tractography through areas of high uncertainty can be improved through repeated Monte Carlo trials. To define our stopping conditions more specifically, we classify each voxel in the brain into of one of categories: non-cortical-barrier (NCB), white matter (WM), and region of interest candidate (ROI-candidate). ROI-candidate voxels are those contained in the cortical barrier, WM voxels are those in white matter, and NCS voxels represent regions that are neither white matter nor a part of the cortical barrier. Tractography will continue through WM regions until we reach an NCB region, in which case the process simply stops and the tract is abandoned, or a ROI-candidate region, in which case we increment a local voxel count. One confounding issue in identifying a cortical barrier is that white matter fibers extend through the brain stem and into the spinal cord. Because a standard MRI does not provide a diffusion image of the entire spinal cord, we placed artificial ROI-candidate voxels at the base of the MRI image where the brain stem would continue on. Though these voxels are not gray matter voxels, they are necessary to ensure the continuity of the cortical barrier. We rely on a dataset of expertly classified voxels in our brain image to produce our final classifications.

The Regional Connectivity Network
Our goal is to explore the underlying connectivity network between cortical regions in a human brain. The proposed approach, Aug3

mented PICo, is highly similar to a breadthfirst search on this connectivity topology. By recursively applying PICo, we are able to learn more about the structure of this network. If this network were entirely known, we would be able to make practical inferences about the relatedness of higher level human functionality. In addition to learning more about how higher level human functions might be linked, we might learn more about the strength of those connections. If we were to start PICo from region A, discover region B, and then "rediscover" region A by starting PICo from B, we might be able to establish that regions A and B are highly associated. On the other hand, if we fail to rediscover A when starting PICo from region B, then A is associated with B unidirectionally; perhaps B is a highly connected piece of the cortex, and the fact that it can be discovered when starting PICo from A is not particularly informative. Taking increasing numbers of steps within the regional cortex network, unfortunately, increases our results' susceptibility to noise. If noise has an effect on the first run of PICo, for instance, the second (recursive) PICo trial, whose starting conditions are highly dependent on the output of the first run, will be less accurate. In a process like this, noise can accumulate substantially. For this reason, we limit ourselves to taking just one recursive step in our breadth-first search, though it would be interesting to examine the extent to which noise accumulates within our algorithm in future work.

Visualizations
We developed a method to visualize the counts of how many Monte Carlo simulations terminated in each voxel of the ROI-candidate region. Such a visualization is particularly important for our experiment because we did not implement any sort of automated peak detection algorithm; rather, we rely on visual detection schemes. In order to identify regions of interest based on our simulations, we require a method of visualizing the resulting discrete 4

spatial count distribution. To accomplish this task, we define a brain center point and project all ROI-candidate voxels onto a unit sphere centered at this point. After this projection step, we have a mapping from ROI-candidate voxels to points on a unit sphere. Next, we compress the longitudinal coordinates of these points on the unit sphere such that the points are compressed in a continuous manner towards the bottom of the sphere. The specific compression function doesn't particularly matter, it only need be continuous. Longitudinal compression is required because the resolution After longitudinal compression, we use a standard stereographic projection to map compressed points on the unit sphere to image coordinates. Finally, we define a final image resolution, bin each of the projected points into a pixel based on its location, and average the Monte Carlo counts associated with each projected point within each pixel to determine a final pixel color. We refer to the resulting images as heatmaps. Notably, this method of visualizing the discrete count field preserves lots of useful properties of the three-dimensional distribution. More specifically, regional continuity is preserved if a continuous longitudinal compression function is used. This means that three-dimensional, continuous regions of interest in the discrete count field result in continuous regions within the two dimensional image (though the region's shape is certainly not preserved). Furthermore, it's easy to invert this process and determine which voxels within the brain are associated with which pixels in the image.

Methods
Our method, in total, is given as follows: 1. Determine the cortical barrier for a given tensor field. 2. Choose a region of interest to start from within the cortex.

3. Perform PICo starting from that region of interest, and compute the index of connectivity from that region to each voxel within the cortical barrier. 4. Examine the connectivity distribution within the cortical barrier. 5. Based on the counts in the connectivity distribution and our distribution visualization scheme, identify new regions of interest, areas where many of the Monte Carlo simulations terminated. 6. Run PICo starting from the new regions of interest, identifying a third set of regions. 7. Examine and analyze the resulting "network" of connectivity. We pick a starting ROI within the middle temporal gyrus, a region of the cortex whose exact function is unknown. From this starting point, we executed 1000 Monte Carlo simulations to produce a discrete count distribution over the cortical barrier. Next, we identified two ROIs in the resulting distribution; ROI A represented the single voxel with the highest number of counts, while ROI B represented the median voxel in a set chosen from our visualization scheme. After identifying ROI A and ROI B, we recursively applied PICo from both of these new regions of interest and produced heatmaps of the resulting count distributions.

meaning most of the tracts terminated before they reached this region.

Figure 1: Heatmap generated through 1000 Monte Carlo simulations, given our seed point. We identified two ROI based on these simulations, ROI A and ROI B.

Results
The heatmap resulting from our seed point, in addition to the identified regions of interest, can be seen in Figure 1. ROI A and ROI B are clearly distinct; this indicates that the visually identified ROI B does not contain the single voxel with the most counts. Therefore, our tracts terminated over distinct regions of the brain. The specific locations of those regions are highlighted in Figure 2. Notably, neither ROI A or ROI B exist in the "outer shell" of ROI-candidate voxels on the brain's edge,

Figure 2: Brain image with labels of approximate locations of our seed point, ROI A, and ROI B. This 2-D transverse plane can only approximate the 3-D locations of these regions.

The results of the recursive application of PICo are demonstrated in Figure 3 and Figure 4. Though the specific locations of regions within these heatmaps do not exactly correspond to regions within the cortical barrier, our recursive application from ROI B appears to visit entirely new cortical regions. This indicates that distinct and varied regions of the cortical 5

barrier can be visited by Augmented PICo.

Figure 3: Heatmap generated through 1000 Monte Carlo simulations, starting our simulations at ROI A.

connectivity network, and, as such, no accuracy statistics can be computed based on the experiments we present here. In the future, we'd like to apply our approach to a known phantom dataset to analyze its accuracy. Aside from using a phanom dataset, it would be reasonable to compare our heatmaps to heatmaps generated from a purely random walk in the tensor field. In this way, we could statistically determine if our heatmaps are indicative of underlying diffusion structure in the brain, or products of random chance. Despite the difficulty of quantitative analysis, we believe our results indicate promise. Particularly enticing are our findings when tracing our initial seed point to ROI B and beyond. The difference between Figure 1 and Figure 4 indicates that a significant portion of the brain has been traversed in these graph transitions, and it's possible that a small portion of the regional connectivity network has been discovered. Limitations to Augmented PICo The PICo approach, like any analysis method deriving from diffusion tensors, suffers from its indirectness; tensors model water diffusion rather than underlying fiber structure itself [6]. Furthermore, Monte Carlo methods can be very computationally intensive; it is often the case that thousands of trials must be executed to achieve accurate results [1]. We only generated 1,000 streamlines for each region of interest, which is likely not thorough enough for our results to confidently indicate structure. Furthermore, the visual identification of peaks given some heatmap is subjective; an algorithmic approach such as expectation maximization would be more precise and might prove to be easier to analyze. Another major limitation of our approach is that tracts are always started towards the brain's center. We included this simplifying assumption because, in cases where the seed point is on the brain's surface, performing tractography away from the brain's center will not produce a meaningful result. It would be

Figure 4: Heatmap generated through 1000 Monte Carlo simulations, starting our simulations at ROI B.

Finally, it's worth noting that the recursive application of PICo to ROI A and ROI B did not result in a return to the seed region. This suggests that the seed point's association with both ROIs is unidirectional.

Discussion
Augmented PICo is difficult to evaluate quantitatively because it is a highly exploratory technique. We have no ground truth of the regional 6

worthwhile, however, for ROI candidate voxels not on the brain's surface, to run PICo assuming an initial direction opposite the brain's center. This simplification might explain why recursive PICo application on ROI A and ROI B did not result in revisiting the seed point. Finally, our approach is highly sensitive to regions of interest nearby the starting point. The proximity of ROI A and ROI B to the seed point indicates that Augmented PICo might have difficulty inferring longer connections, even if such connections existed. Perhaps our approach could be extended to model uncertainty in ending conditions; if an encountered ROI candidate voxel has a large number of white matter voxel neighbors, it might be reasonable to continue tractography with some probability. We leave this question and others to future work.

[3] Behrens T, Johansen Berg H, Jbabdi S, Rushworth M, Woolricha M. Probabilistic diffusion tractography with multiple fibre orientations: What can we gain? NeuroImage. 2007; 34: 144-155. [4] Mukherjeea P, Bermana J, Chunga S, Hessa C, Henrya R. Diffusion Tensor MR Imaging and Fiber Tractography: Theoretic Underpinnings. American Journal of Neuroradiology. 2008; 29: 632-641. [5] Jones D, Catani M, Pierpaoli C, Reeves S, Shergill S, O'Sullivan M, Golesworthy P, McGuire P, Horsfield M, Simmons A, Williams S, Howards R. Age effects on diffusion tensor magnetic resonance imaging tractography measures of frontal cortex connections in schizophrenia. Human Brain Mapping. 2006; 27:230-238. [6] Descoteaux M, Deriche R, Knösche T, Anwander A. Deterministic and probabilistic tractography based on complex fibre orientation distributions. Medical Imaging, IEEE transactions on. 2009; 28: 269-286. [7] Lin C, Isaac W, Cheng T, Chen J. Validation of diffusion tensor magnetic resonance axonal fiber imaging with registered manganese-enhanced optic tracts. NeuroImage. 2001; 14: 1035-1047.

References
[1] Parker G, Haroon H, Wheeler-Kingshott C. A framework for a streamline-based probabilistic index of connectivity (PICo) using a structural interpretation of MRI diffusion measurements. Journal of Magnetic Resonance Imaging. 2003; 18: 242-254. [2] Basser P, Pajevic S, Pierpaoli C, Duda J, Aldroubi A. In vivo fiber tractography using DT-MRI data. Magnetic Resonance in Medicine. 2000; 44: 625-632.

7

